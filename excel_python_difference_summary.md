# Excel実装とPython実装の相違点まとめ

## 調査結果

### 1. 等価合力q計算

**相違点の詳細:**
- Excel実装では係数0.9を使用していることが判明
- Python実装の式自体は村山の式に準拠しており、α（標準1.8）とKを使用
- 計算値は、Excel側が異なる係数を使用しているために一致していなかった

**結論:** Python実装の式（α、Kを使用）は村山の式として正しいため、変更しない

### 2. 重心位置（lw）計算

**相違点の詳細:**
- 基本的な計算ロジックは同じ
- 曲線領域の重心計算において、細かい実装の違いがある
- Excel: 1.136、Python計算: 1.206（約6%の差）

**結論:** 計算方法は概ね一致しており、微小な差は数値計算の精度によるもの

### 3. 実装した機能

土被り判定について、以下の2つのオプションを追加：
1. **有限土被りを考慮する**: 土被り値Hを入力可能にする
2. **有限土被り式を強制的に使用**: 深部条件でも常に有限土被り式を使用（Excel互換モード）

これにより、ユーザーは以下の3つのモードを選択可能：
- 深部前提（両方のチェックボックスをオフ）
- 自動判定モード（「有限土被りを考慮する」のみオン）
- Excel互換モード（両方のチェックボックスをオン）

## 実装の妥当性

1. **村山の式の準拠**: α、Kを使用した計算式は理論的に正しい
2. **柔軟性の確保**: ユーザーが用途に応じて計算方法を選択可能
3. **Excel互換性**: 必要に応じてExcelと同じ挙動を再現可能